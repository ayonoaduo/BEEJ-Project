{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _slicedToArray from\"/Users/okienayonoadu/beej/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';//import {Button} from '@material-ui/core';\nimport firebase from\"firebase\";import{storage,db}from'./firebase';import'./ImageUpload.css';function ImageUpload(_ref){var username=_ref.username;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),caption=_useState2[0],setCaption=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];//state for the progress bar\nvar _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),progress=_useState6[0],setProgress=_useState6[1];var handleChange=function handleChange(e){//handleChange function fires off an event\nif(e.target.files[0]){//get the first file you selected\nsetImage(e.target.files[0]);//set the image in state to that file\n}};var handleUpload=function handleUpload(){//access the storage in firebase, get a references to the folder images/ and store image there\nvar uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",/*provide snapshot of the image uploading progress via an equation*/function(snapshot){//progress function ...\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){//error function ..\nconsole.log(error);alert(error.message);},function(){// complete function ...\nstorage.ref(\"images\").child(image.name).getDownloadURL()//GET DOWNLOAD LINK TO THE IMAGE\n.then(function(url){//post image inside db\ndb.collection(\"posts\").add({//get server timestamp so images are sorted by time posted\ntimestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageUrl:url,username:username});setProgress(0);//reset progress\nsetCaption(\"\");setImage(null);});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageupload\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"imageupload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a caption...\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{onClick:handleUpload,children:\"Upload\"})]});}export default ImageUpload;","map":{"version":3,"sources":["/Users/okienayonoadu/beej/src/ImageUpload.js"],"names":["React","useState","firebase","storage","db","ImageUpload","username","caption","setCaption","image","setImage","progress","setProgress","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"oMAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,KAA8B,OAA9B,CACA;AACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,OAAQC,OAAR,CAAiBC,EAAjB,KAA0B,YAA1B,CACA,MAAO,mBAAP,CAEA,QAASC,CAAAA,WAAT,MAAiC,IAAXC,CAAAA,QAAW,MAAXA,QAAW,eACCL,QAAQ,CAAC,EAAD,CADT,wCACtBM,OADsB,eACbC,UADa,8BAEHP,QAAQ,CAAC,IAAD,CAFL,yCAEtBQ,KAFsB,eAEfC,QAFe,eAEa;AAFb,eAGGT,QAAQ,CAAC,CAAD,CAHX,yCAGtBU,QAHsB,eAGZC,WAHY,eAO7B,GAAMC,CAAAA,YAAY,CAAI,QAAhBA,CAAAA,YAAgB,CAACC,CAAD,CAAO,CAAC;AAC1B,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,CAAuB,CAAE;AACrBN,QAAQ,CAACI,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CAA6B;AAChC,CACJ,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB;AACA,GAAMC,CAAAA,UAAU,CAAGf,OAAO,CAACgB,GAAR,kBAAsBV,KAAK,CAACW,IAA5B,GAAoCC,GAApC,CAAwCZ,KAAxC,CAAnB,CAEAS,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,oEACA,SAACC,QAAD,CAAc,CACV;AACA,GAAMZ,CAAAA,QAAQ,CAAGa,IAAI,CAACC,KAAL,CACZF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADvC,CAAjB,CAGAf,WAAW,CAACD,QAAD,CAAX,CACH,CATL,CAUI,SAACiB,KAAD,CAAW,CACP;AACAC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACH,CAdL,CAeI,UAAM,CACF;AACA7B,OAAO,CACFgB,GADL,CACS,QADT,EAEKc,KAFL,CAEWxB,KAAK,CAACW,IAFjB,EAGKc,cAHL,EAGwB;AAHxB,CAIKC,IAJL,CAIU,SAAAC,GAAG,CAAI,CACT;AACAhC,EAAE,CAACiC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACvB;AACAC,SAAS,CAAErC,QAAQ,CAACsC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EAFY,CAGvBnC,OAAO,CAAEA,OAHc,CAIvBoC,QAAQ,CAAEP,GAJa,CAKvB9B,QAAQ,CAAEA,QALa,CAA3B,EAQAM,WAAW,CAAC,CAAD,CAAX,CAAgB;AAChBJ,UAAU,CAAC,EAAD,CAAV,CACAE,QAAQ,CAAC,IAAD,CAAR,CACH,CAjBL,EAkBH,CAnCL,EAqCH,CAzCD,CA2CA,mBACI,aAAK,SAAS,CAAC,aAAf,wBACI,iBAAU,SAAS,CAAC,uBAApB,CAA4C,KAAK,CAAEC,QAAnD,CAA6D,GAAG,CAAC,KAAjE,EADJ,cAEG,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,oBAA/B,CAAoD,QAAQ,CAAE,kBAAAiC,KAAK,QAAIpC,CAAAA,UAAU,CAACoC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAAd,EAAnE,CAAuG,KAAK,CAAEtC,OAA9G,EAFH,cAGG,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEM,YAA7B,EAHH,cAIG,eAAQ,OAAO,CAAEI,YAAjB,oBAJH,GADJ,CAWH,CAED,cAAeZ,CAAAA,WAAf","sourcesContent":["import React, {useState} from 'react';\n//import {Button} from '@material-ui/core';\nimport firebase from \"firebase\";\nimport {storage, db} from './firebase';\nimport './ImageUpload.css';\n\nfunction ImageUpload({username}) {\n    const [caption, setCaption] = useState('');\n    const [image, setImage] = useState(null); //state for the progress bar\n    const [progress, setProgress] = useState(0);\n   \n    \n\n    const handleChange =  (e) => {//handleChange function fires off an event\n        if (e.target.files[0]) { //get the first file you selected\n            setImage(e.target.files[0]); //set the image in state to that file\n        }\n    };\n\n    const handleUpload = () => {\n        //access the storage in firebase, get a references to the folder images/ and store image there\n        const uploadTask = storage.ref(`images/${image.name}`).put(image);\n\n        uploadTask.on(\n            \"state_changed\",\n            /*provide snapshot of the image uploading progress via an equation*/\n            (snapshot) => {\n                //progress function ...\n                const progress = Math.round(\n                    (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n                );\n                setProgress(progress);\n            },\n            (error) => {\n                //error function ..\n                console.log(error);\n                alert(error.message);\n            },\n            () => {\n                // complete function ...\n                storage\n                    .ref(\"images\")\n                    .child(image.name)\n                    .getDownloadURL()   //GET DOWNLOAD LINK TO THE IMAGE\n                    .then(url => {\n                        //post image inside db\n                        db.collection(\"posts\").add({\n                            //get server timestamp so images are sorted by time posted\n                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n                            caption: caption,\n                            imageUrl: url,\n                            username: username\n                        });\n\n                        setProgress(0); //reset progress\n                        setCaption(\"\");\n                        setImage(null);\n                    });\n            }\n        );\n    };\n\n    return (\n        <div className=\"imageupload\">\n            <progress className=\"imageupload__progress\" value={progress} max=\"100\"/>\n           <input type=\"text\" placeholder='Enter a caption...' onChange={event => setCaption(event.target.value)} value={caption}/>\n           <input type=\"file\" onChange={handleChange} />\n           <button onClick={handleUpload}>\n            Upload\n           </button>\n\n        </div>\n    )\n}\n\nexport default ImageUpload"]},"metadata":{},"sourceType":"module"}